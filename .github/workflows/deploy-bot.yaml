---
name: Deploy BloopyBoi to Neutrino

# Run workflow on tags starting with v (eg. v2, v1.2.0)
on:
  workflow_dispatch:
  # push:
  #   branches:
  #     - main

jobs:
  Run PyLint:
    uses: h3mmy/bloopyboi/.github/workflows/pylint.yml@main

  Run Unit Tests:
    uses: h3mmy/bloopyboi/.github/workflows/python-app.yml@main

  Build and Deploy Image:
    uses: h3mmy/bloopyboi/.github/workflows/deploy-image.yaml@main

  Deploy to Node:
    environment: quarkynet
    uses: h3mmy/bloopyboi/.github/workflows/remote-docker-up.yaml@main
    with:
      username: ${{ secrets.NEUTRINO_USER_NAME }}
      remoteDir: ${{ secrets.DOCKER_REMOTE_DIR }}
      remoteHost: ${{ secrets.HOST_0_NAME }}
    secrets:
      envPAT: ${{ secrets.GITHUB_TOKEN }}
      remoteSshKey: ${{ secrets.NEUTRINO_SSH_KEY }}
